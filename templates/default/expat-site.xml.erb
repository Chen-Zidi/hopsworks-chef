<?xml version="1.0" encoding="UTF-8"?>
<expat>
    <database>
        <url>jdbc:mysql://<%= @mysql_ip %>/hopsworks</url>
        <driver>com.mysql.jdbc.Driver</driver>
        <user><%= node['mysql']['user'] %></user>
        <password><%= node['mysql']['password'] %></password>
    </database>

    <x509>
        <masterPwdFile><%= node['certs']['dir'] %>/encryption_master_password</masterPwdFile>
        <intermediateCA><%= node['certs']['dir'] %>/intermediate</intermediateCA>
        <userCertsScript>createusercerts.sh</userCertsScript>
    </x509>

    <kube>
        <user>hopsworks</user>
        <masterUrl>https://<%= @api_server %>:<%= node['kube-hops']['apiserver']['port'] %></masterUrl>
        <caPath><%= node['certs']['dir'] %>/kube/certs/kube-ca.cert.pem</caPath>
        <tstorePath><%= node['certs']['dir'] %>/kube/hopsworks/hopsworks__tstore.jks</tstorePath>
        <tstorePwd><%= node['kube-hops']['hopsworks_cert_pwd'] %></tstorePwd>
        <kstorePath><%= node['certs']['dir'] %>/kube/hopsworks/hopsworks__kstore.jks</kstorePath>
        <kstorePwd><%= node['kube-hops']['hopsworks_cert_pwd'] %></kstorePwd>
        <certFile><%= node['certs']['dir'] %>/kube/hopsworks/hopsworks.cert.pem</certFile>
        <keyFile><%= node['certs']['dir'] %>/kube/hopsworks/hopsworks.key.pem</keyFile>
        <keyPwd><%= node['kube-hops']['hopsworks_cert_pwd'] %></keyPwd>
    </kube>

    <version-060>
        io.hops.hopsworks.expat.migrations.x509.GenerateProjectCertificates
        io.hops.hopsworks.expat.migrations.x509.GenerateUserCertificates
        io.hops.hopsworks.expat.migrations.jobs.JobsGpuMigration
        io.hops.hopsworks.expat.migrations.kubernetes.CreateNS
        io.hops.hopsworks.expat.migrations.kubernetes.CreateCertSecrets
    </version-060>

</expat>
